<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><link href="css/default.css" rel="stylesheet" type="text/css" /><script src="js/jquery.min.js" type="text/javascript"></script><script src="js/page_effects.js" type="text/javascript"></script><title>carry-persistence.core documentation</title></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Carry</span> <span class="project-version">0.1.0</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>carry-debugger</span></div></div></li><li class="depth-2"><a href="carry-debugger.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>carry-history</span></div></div></li><li class="depth-2"><a href="carry-history.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>carry-logging</span></div></div></li><li class="depth-2"><a href="carry-logging.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>carry-persistence</span></div></div></li><li class="depth-2 current"><a href="carry-persistence.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>carry-reagent</span></div></div></li><li class="depth-2"><a href="carry-reagent.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>carry-schema</span></div></div></li><li class="depth-2"><a href="carry-schema.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>carry</span></div></div></li><li class="depth-2"><a href="carry.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="carry-persistence.core.html#var-add"><div class="inner"><span>add</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">carry-persistence.core</h1><div class="doc"><div class="markdown"></div></div><div class="public anchor" id="var-add"><h3>add</h3><div class="usage"><code>(add spec storage key)</code><code>(add spec storage key {:keys [blacklist load-wrapper], :or {blacklist #{}, load-wrapper identity}, :as _options})</code></div><div class="doc"><div class="markdown"><p>On start middleware will load the model from storage. Saves model into storage on every change. Several middlewares can safely wrap the same spec as long as they use different storage keys.</p>
<p>Storage is expected to be a transient map (e.g. see hodgepodge lib). If this middleware is applied to spec several times then all keys must differ; otherwise, behavior is undefined. Optional :blacklist set should contain model keys which will not be saved and loaded. Optional :load-wrapper allows decorating model update function (e.g. it’s possible to cancel loading based on loaded data).</p>
<p>Middleware is friendly to carry-debugger:</p>
<ul>
  <li>it won’t persist debugger data in order to not conflict with debugger’s persistence implementation</li>
  <li>it won’t load model from storage on app start if debugger’s replay mode is on</li>
</ul></div></div><div class="src-link"><a href="https://github.com/metametadata/carry/blob/master/contrib/persistence/src/carry_persistence/core.cljs#L59">view source</a></div></div></div></body></html>